<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=61963&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>CVE-2023-23489 - Easy Digital Downloads WordPress Plugin &lt; 3.1.4 - unauthenticated SQL injection | Emad&#39;s Blog</title>
<meta name="keywords" content="cve_analysis, xdebug">
<meta name="description" content="
Description
The Easy Digital Downloads WordPress Plugin, versions 3.1.0.2 &amp; 3.1.0.3, is affected by an unauthenticated SQL injection vulnerability in the &rsquo;s&rsquo; parameter of its &rsquo;edd_download_search&rsquo; action.

Lab-Setup
mkdir cve-2023-23489
Dockerfile
FROM wordpress:latest

# Install development tools and dependencies
RUN apt-get update &amp;&amp; apt-get install -y \
    vim \
    subversion \
    git \
    unzip \
    mariadb-client \
    less \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# Install Xdebug for debugging
RUN pecl install xdebug &amp;&amp; docker-php-ext-enable xdebug

# Properly configure Xdebug
RUN echo &#34;zend_extension=xdebug&#34; &gt; /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini \
    &amp;&amp; echo &#34;xdebug.mode=debug&#34; &gt;&gt; /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini \
    &amp;&amp; echo &#34;xdebug.start_with_request=yes&#34; &gt;&gt; /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini \
    &amp;&amp; echo &#34;xdebug.remote_enable=on&#34; &gt;&gt; /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini \
    &amp;&amp; echo &#34;xdebug.remote_host=host.docker.internal&#34; &gt;&gt; /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini \
    &amp;&amp; echo &#34;xdebug.remote_port=9003&#34; &gt;&gt; /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini \
    &amp;&amp; echo &#34;xdebug.log=/tmp/xdebug.log&#34; &gt;&gt; /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini

# Set permissions for WordPress files
RUN chown -R www-data:www-data /var/www/html

# Added phpinfo file
COPY phpinfo.php /var/www/html/phpinfo.php
COPY wp-config.php /var/www/html/wp-config.php

# Set working directory
WORKDIR /var/www/html
Note
I got the path of Xdebug Configuration files /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini when the docker container is up i executed this command to get it php --ini

docker-compose.yml">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:61963/posts/cve-2023-23489-easy-digital-downloads-wordpress-plugin-less-314-unauthenticated-sqli/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.78ba77c4908a32fe0c70eeb7c5dcd1ce98217af4dd36f64e54660afb06008c71.css" integrity="sha256-eLp3xJCKMv4McO63xdzRzpghevTdNvZOVGYK&#43;wYAjHE=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:61963/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:61963/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:61963/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:61963/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:61963/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:61963/posts/cve-2023-23489-easy-digital-downloads-wordpress-plugin-less-314-unauthenticated-sqli/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:61963/" accesskey="h" title="Emad&#39;s Blog (Alt + H)">Emad&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:61963/" title="Home">
                    <span><i class='fas fa-home'></i>&nbsp;Home</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:61963/posts/" title="Posts">
                    <span><i class='fas fa-folder'></i>&nbsp;Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:61963/about/" title="About">
                    <span><i class='fas fa-heart'></i>&nbsp;About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CVE-2023-23489 - Easy Digital Downloads WordPress Plugin &lt; 3.1.4 - unauthenticated SQL injection
    </h1>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><p><img alt="Description of Image" loading="lazy" src="/images/cve-2023-23489/cve-poster.png"></p>
<h3 id="description">Description<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h3>
<p>The Easy Digital Downloads WordPress Plugin, versions 3.1.0.2 &amp; 3.1.0.3, is affected by an unauthenticated SQL injection vulnerability in the &rsquo;s&rsquo; parameter of its &rsquo;edd_download_search&rsquo; action.</p>
<p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/cve-2023-23489-severity.png"></p>
<h3 id="lab-setup">Lab-Setup<a hidden class="anchor" aria-hidden="true" href="#lab-setup">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>mkdir cve-2023-23489
</span></span></code></pre></div><p><code>Dockerfile</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">FROM</span> <span style="color:#a6e22e">wordpress</span><span style="color:#f92672">:</span><span style="color:#a6e22e">latest</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Install development tools and dependencies
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">RUN</span> <span style="color:#a6e22e">apt</span><span style="color:#f92672">-</span><span style="color:#a6e22e">get</span> <span style="color:#a6e22e">update</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">apt</span><span style="color:#f92672">-</span><span style="color:#a6e22e">get</span> <span style="color:#a6e22e">install</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">y</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">vim</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">subversion</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">git</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">unzip</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">mariadb</span><span style="color:#f92672">-</span><span style="color:#a6e22e">client</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">less</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">rm</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">rf</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">lib</span><span style="color:#f92672">/</span><span style="color:#a6e22e">apt</span><span style="color:#f92672">/</span><span style="color:#a6e22e">lists</span><span style="color:#f92672">/*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Install Xdebug for debugging
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">RUN</span> <span style="color:#a6e22e">pecl</span> <span style="color:#a6e22e">install</span> <span style="color:#a6e22e">xdebug</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">enable</span> <span style="color:#a6e22e">xdebug</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Properly configure Xdebug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">RUN</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;zend_extension=xdebug&#34;</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;xdebug.mode=debug&#34;</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;xdebug.start_with_request=yes&#34;</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;xdebug.remote_enable=on&#34;</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;xdebug.remote_host=host.docker.internal&#34;</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;xdebug.remote_port=9003&#34;</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span> <span style="color:#a6e22e">\</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;xdebug.log=/tmp/xdebug.log&#34;</span> <span style="color:#f92672">&gt;&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">-</span><span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ext</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set permissions for WordPress files
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">RUN</span> <span style="color:#a6e22e">chown</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">R</span> <span style="color:#a6e22e">www</span><span style="color:#f92672">-</span><span style="color:#a6e22e">data</span><span style="color:#f92672">:</span><span style="color:#a6e22e">www</span><span style="color:#f92672">-</span><span style="color:#a6e22e">data</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">www</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Added phpinfo file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">COPY</span> <span style="color:#a6e22e">phpinfo</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">www</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span><span style="color:#f92672">/</span><span style="color:#a6e22e">phpinfo</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">COPY</span> <span style="color:#a6e22e">wp</span><span style="color:#f92672">-</span><span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">www</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span><span style="color:#f92672">/</span><span style="color:#a6e22e">wp</span><span style="color:#f92672">-</span><span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set working directory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">WORKDIR</span> <span style="color:#f92672">/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">www</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span>
</span></span></code></pre></div><p><strong>Note</strong>
I got the path of Xdebug Configuration files <code>/usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini</code> when the docker container is up i executed this command to get it <code>php --ini</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/php-ini.png">
<code>docker-compose.yml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;3&#34;</span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Defines which compose version to use
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">services</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">db</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">image</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">mysql</span><span style="color:#f92672">:</span><span style="color:#ae81ff">5.7</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">restart</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">MYSQL_ROOT_PASSWORD</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">MySQLP</span><span style="color:#f92672">@</span><span style="color:#a6e22e">ssw0rd</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">MYSQL_DATABASE</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">WordPressDatabaseName</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">MYSQL_USER</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">WordPressUser</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">MYSQL_PASSWORD</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">P</span><span style="color:#f92672">@</span><span style="color:#a6e22e">ssw0rd</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ports</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#e6db74">&#34;3306:3306&#34;</span>  <span style="color:#75715e"># Allow access to MySQL from host (optional)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">mysql</span><span style="color:#f92672">:/</span><span style="color:#66d9ef">var</span><span style="color:#f92672">/</span><span style="color:#a6e22e">lib</span><span style="color:#f92672">/</span><span style="color:#a6e22e">mysql</span>  <span style="color:#75715e"># Persist MySQL data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">wordpress</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">depends_on</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#a6e22e">db</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">build</span><span style="color:#f92672">:</span> <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">restart</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ports</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">-</span> <span style="color:#e6db74">&#34;8000:80&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">environment</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">WORDPRESS_DB_HOST</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">db</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3306</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">WORDPRESS_DB_USER</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">WordPressUser</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">WORDPRESS_DB_PASSWORD</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">P</span><span style="color:#f92672">@</span><span style="color:#a6e22e">ssw0rd</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">WORDPRESS_DB_NAME</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">WordPressDatabaseName</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">volumes</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mysql</span><span style="color:#f92672">:</span>  <span style="color:#75715e"># Persistent MySQL data
</span></span></span></code></pre></div><p><code>phpinfo.php</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">echo</span> <span style="color:#e6db74">&#34;&lt;?php phpinfo(); ?&gt;&#34;</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">phpinfo</span>.<span style="color:#a6e22e">php</span>
</span></span></code></pre></div><p>I updated the <code>wp-config.php</code> file to enable debugging</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * The base configuration for WordPress
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * The wp-config.php creation script uses this file during the installation.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * You don&#39;t have to use the website, you can copy this file to &#34;wp-config.php&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * and fill in the values.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * This file contains the following configurations:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * * Database settings
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * * Secret keys
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * * Database table prefix
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * * ABSPATH
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * This has been slightly modified (to read environment variables) for use in Docker.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @package WordPress
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// IMPORTANT: this file needs to stay in-sync with https://github.com/WordPress/WordPress/blob/master/wp-config-sample.php
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// (it gets parsed by the upstream wizard in https://github.com/WordPress/WordPress/blob/f27cb65e1ef25d11b535695a660e7282b98eb742/wp-admin/setup-config.php#L356-L392)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// a helper function to lookup &#34;env_FILE&#34;, &#34;env&#34;, then fallback
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">function_exists</span>(<span style="color:#e6db74">&#39;getenv_docker&#39;</span>)) {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// https://github.com/docker-library/wordpress/issues/588 (WP-CLI will load this file 2x)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getenv_docker</span>($env, $default) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ($fileEnv <span style="color:#f92672">=</span> <span style="color:#a6e22e">getenv</span>($env <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;_FILE&#39;</span>)) {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">rtrim</span>(<span style="color:#a6e22e">file_get_contents</span>($fileEnv), <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (($val <span style="color:#f92672">=</span> <span style="color:#a6e22e">getenv</span>($env)) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> $val;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> $default;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ** Database settings - You can get this info from your web host ** //
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#e6db74">/** The name of the database for WordPress */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;DB_NAME&#39;</span>, <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_DB_NAME&#39;</span>, <span style="color:#e6db74">&#39;wordpress&#39;</span>) );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/** Database username */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;DB_USER&#39;</span>, <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_DB_USER&#39;</span>, <span style="color:#e6db74">&#39;example username&#39;</span>) );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/** Database password */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;DB_PASSWORD&#39;</span>, <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_DB_PASSWORD&#39;</span>, <span style="color:#e6db74">&#39;example password&#39;</span>) );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * Docker image fallback values above are sourced from the official WordPress installation wizard:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * https://github.com/WordPress/WordPress/blob/1356f6537220ffdc32b9dad2a6cdbe2d010b7a88/wp-admin/setup-config.php#L224-L238
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * (However, using &#34;example username&#34; and &#34;example password&#34; in your database is strongly discouraged.  Please use strong, random credentials!)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/** Database hostname */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;DB_HOST&#39;</span>, <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_DB_HOST&#39;</span>, <span style="color:#e6db74">&#39;mysql&#39;</span>) );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/** Database charset to use in creating database tables. */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;DB_CHARSET&#39;</span>, <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_DB_CHARSET&#39;</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>) );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/** The database collate type. Don&#39;t change this if in doubt. */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;DB_COLLATE&#39;</span>, <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_DB_COLLATE&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>) );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/**#@+
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * Authentication unique keys and salts.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * Change these to different unique phrases! You can generate these using
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * You can change these at any point in time to invalidate all existing cookies.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * This will force all users to have to log in again.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @since 2.6.0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;AUTH_KEY&#39;</span>,         <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_AUTH_KEY&#39;</span>,         <span style="color:#e6db74">&#39;f9b373ffa89b6310ea66306e2e256351c2293518&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;SECURE_AUTH_KEY&#39;</span>,  <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_SECURE_AUTH_KEY&#39;</span>,  <span style="color:#e6db74">&#39;e6b0cac823d4270c0d4240fecaa167579a2a77aa&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;LOGGED_IN_KEY&#39;</span>,    <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_LOGGED_IN_KEY&#39;</span>,    <span style="color:#e6db74">&#39;c0c276e7ab64e57ad8457844453a354083e271f4&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;NONCE_KEY&#39;</span>,        <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_NONCE_KEY&#39;</span>,        <span style="color:#e6db74">&#39;786d6c04dea080c461b9510402c7231f5ae8e4f1&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;AUTH_SALT&#39;</span>,        <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_AUTH_SALT&#39;</span>,        <span style="color:#e6db74">&#39;88e8eb4fe52c0289e6970de0082b58f7ec9fd3af&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;SECURE_AUTH_SALT&#39;</span>, <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_SECURE_AUTH_SALT&#39;</span>, <span style="color:#e6db74">&#39;8dfeb7b37d302374d2a11b2f7267cd17013132d1&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;LOGGED_IN_SALT&#39;</span>,   <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_LOGGED_IN_SALT&#39;</span>,   <span style="color:#e6db74">&#39;8585878381aa816109b8d23b85061b7c6e3b3740&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;NONCE_SALT&#39;</span>,       <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_NONCE_SALT&#39;</span>,       <span style="color:#e6db74">&#39;570b9d081014b1380d940d93501c048aaaa35f5e&#39;</span>) );
</span></span><span style="display:flex;"><span><span style="color:#75715e">// (See also https://wordpress.stackexchange.com/a/152905/199287)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/**#@-*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * WordPress database table prefix.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * You can have multiple installations in one database if you give each
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * a unique prefix. Only numbers, letters, and underscores please!
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * At the installation time, database tables are created with the specified prefix.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * Changing this value after WordPress is installed will make your site think
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * it has not been installed.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/#table-prefix
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> */</span>
</span></span><span style="display:flex;"><span>$table_prefix <span style="color:#f92672">=</span> <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_TABLE_PREFIX&#39;</span>, <span style="color:#e6db74">&#39;wp_&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * For developers: WordPress debugging mode.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * Change this to true to enable the display of notices during development.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * It is strongly recommended that plugin and theme developers use WP_DEBUG
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * in their development environments.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * For information on other constants that can be used for debugging,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * visit the documentation.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> *
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * @link https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;WP_DEBUG&#39;</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;WP_DEBUG_LOG&#39;</span>, <span style="color:#e6db74">&#39;/var/www/html/wp-content/debug.log&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">define</span>(<span style="color:#e6db74">&#39;WP_DEBUG_DISPLAY&#39;</span>, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span><span style="color:#f92672">@</span><span style="color:#a6e22e">ini_set</span>(<span style="color:#e6db74">&#39;log_errors&#39;</span>, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#f92672">@</span><span style="color:#a6e22e">ini_set</span>(<span style="color:#e6db74">&#39;display_errors&#39;</span>, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* Add any custom values between this line and the &#34;stop editing&#34; line. */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// If we&#39;re behind a proxy server and using HTTPS, we need to alert WordPress of that fact
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// see also https://wordpress.org/support/article/administration-over-ssl/#using-a-reverse-proxy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isset</span>($_SERVER[<span style="color:#e6db74">&#39;HTTP_X_FORWARDED_PROTO&#39;</span>]) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">strpos</span>($_SERVER[<span style="color:#e6db74">&#39;HTTP_X_FORWARDED_PROTO&#39;</span>], <span style="color:#e6db74">&#39;https&#39;</span>) <span style="color:#f92672">!==</span> <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>	$_SERVER[<span style="color:#e6db74">&#39;HTTPS&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;on&#39;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// (we include this by default because reverse proxying is extremely common in container environments)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($configExtra <span style="color:#f92672">=</span> <span style="color:#a6e22e">getenv_docker</span>(<span style="color:#e6db74">&#39;WORDPRESS_CONFIG_EXTRA&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">eval</span>($configExtra);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* That&#39;s all, stop editing! Happy publishing. */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/** Absolute path to the WordPress directory. */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span> <span style="color:#a6e22e">defined</span>( <span style="color:#e6db74">&#39;ABSPATH&#39;</span> ) ) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">define</span>( <span style="color:#e6db74">&#39;ABSPATH&#39;</span>, <span style="color:#66d9ef">__DIR__</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/&#39;</span> );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/** Sets up WordPress vars and included files. */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">require_once</span> <span style="color:#a6e22e">ABSPATH</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;wp-settings.php&#39;</span>;
</span></span></code></pre></div><p>This are all the created files
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/l1.png">
<em>Install Xdebug</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">sudo</span> <span style="color:#a6e22e">apt</span> <span style="color:#a6e22e">install</span> <span style="color:#a6e22e">php</span><span style="color:#f92672">-</span><span style="color:#a6e22e">xdebug</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">y</span>
</span></span></code></pre></div><blockquote>
<p>Find <code>Xdebug</code> Configuration files</p></blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">locate</span> <span style="color:#a6e22e">xdebug</span>.<span style="color:#a6e22e">ini</span>
</span></span></code></pre></div><p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/xdebug.png"></p>
<p>Xdebug Configurations</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">zend_extension</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">so</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">mode</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">debug</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">start_with_request</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">trigger</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">client_port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">9003</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">client_host</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">host</span><span style="color:#f92672">.</span><span style="color:#a6e22e">docker</span><span style="color:#f92672">.</span><span style="color:#a6e22e">internal</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">log</span> <span style="color:#f92672">=</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">tmp</span><span style="color:#f92672">/</span><span style="color:#a6e22e">xdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">log</span>
</span></span></code></pre></div><p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/xdebug-config.png"></p>
<p>We will use Visual Studio Code for Debugging the Vulnerability</p>
<p>Install <a href="https://code.visualstudio.com/">Visual Studio Code</a></p>
<p>After Installation go to Visual Studio Code Extenstions
<img src="/images/cve-2023-23489/install-icon-vscode.png#center" alt="Image" /></p>
<p>Install this Extensions
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/Installed-extensions.png"></p>
<p>To build the Docker Container
<code>docker-compose up</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/docker-compse-up.png"></p>
<p>To see all running containers
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/docker-ps.png"></p>
<p>When you go to <a href="http://localhost:8000/">http://localhost:8000/</a> you will see the wordpress installation page
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/wordpress-install.png">
<br>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/wordpress-install2.png">
<br>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/wordpress-plugins.png">
<br>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/upload-plugins.png">
I searched for <code>easy digital downloads</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/easy-digital-downloads-search.png">
<br>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/wordpress-easy-digital-home-page.png">
Go to Advanced View Section
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/wordpress-easy-digital-home-page-Advnaced-View.png">
The Description of the vulnerability says that version 3.1.0.3 is vulnerable we will download both 3.1.0.3 &amp; 3.1.0.4 to see the patch of the vulnerability
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/easy-digital-home-page-Development-Version.png">
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/easy-digital-downloads-downloaded.png">
First lets upload the vulnerable plugin to wordpress press Browse button and choose easy-digital-downloads.3.1.0.3.zip
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/upload2.png">
Press <code>Install Now</code> Button
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/install-plugin1.png">
You will got this error, we need to change the max file size
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/plugin-upload-error.png">
Open a shell on docker container and execute this commands</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;upload_max_filesize = 50M
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">post_max_size = 100M
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">max_execution_time = 300
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">memory_limit = 256M&#34;</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">usr</span><span style="color:#f92672">/</span><span style="color:#a6e22e">local</span><span style="color:#f92672">/</span><span style="color:#a6e22e">etc</span><span style="color:#f92672">/</span><span style="color:#a6e22e">php</span><span style="color:#f92672">/</span><span style="color:#a6e22e">conf</span><span style="color:#f92672">.</span><span style="color:#a6e22e">d</span><span style="color:#f92672">/</span><span style="color:#a6e22e">custom</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ini</span>
</span></span></code></pre></div><p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/docker-container-shell.png">
Then restart Docker container
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/docker-restart.png">
If we try to install plugin again
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/install-plugin1.png">
It will be uploaded successfully, press the <code>Activate Plugin</code> button
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/uploaded-successfuly.png">
The plugin is installed successfully
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/plugin-installed.png"></p>
<p>Open Visual Studio Code and press <code>Remote Explorer</code> then choose <code>Attackin Current Window</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/remote-debugger-open.png">
Then go to <code>Extensions</code> and Install <code>PHP Debug</code> on the container will be needed for Xdebug
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/Extensions-Install.png">
Choose Open Folder from File
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/File-open-folder.png">
This bar will appears
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/open-folder-bar.png">
we need to open the Apache directory where wordpress files are installed which is under <code>/var/www/html</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/var-www-html.png">
The content of the container is appeared
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/container-content.png"></p>
<p>Lets test the debug is working by debugging first file phpinfo.php
<br>
Go to <code>Run - Start Debugging</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/test-debugging-xdebug.png">
Then press on <code>create a launch.json file</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/create-jaon-launch.png">
launch.json file will show
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/launch-json-default.png">
I updated the launch.json file to work on the current directory that we opened <code>/var/www/html</code>
<br>
Updated launch.json file :-</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Use IntelliSense to learn about possible attributes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Hover to view descriptions of existing attributes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#34;version&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;0.2.0&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;configurations&#34;</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Listen for Xdebug&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;php&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;request&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;launch&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;port&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">9003</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;stopOnEntry&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;pathMappings&#34;</span><span style="color:#f92672">:</span> {<span style="color:#e6db74">&#34;/var/www/html&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>workspaceFolder}&#34;<span style="color:#e6db74">}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">name</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">Launch</span> <span style="color:#a6e22e">currently</span> <span style="color:#a6e22e">open</span> <span style="color:#a6e22e">script</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">type</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">php</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">request</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">launch</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">program</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">file</span>}<span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">cwd</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">fileDirname</span>}<span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">port</span><span style="color:#e6db74">&#34;: 0,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">runtimeArgs</span><span style="color:#e6db74">&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#f92672">-</span><span style="color:#a6e22e">dxdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">start_with_request</span><span style="color:#f92672">=</span><span style="color:#a6e22e">yes</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">env</span><span style="color:#e6db74">&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#a6e22e">XDEBUG_MODE</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">debug</span>,<span style="color:#a6e22e">develop</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#a6e22e">XDEBUG_CONFIG</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">client_port</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">port</span>}<span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        },
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">name</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">Launch</span> <span style="color:#a6e22e">Built</span><span style="color:#f92672">-</span><span style="color:#a6e22e">in</span> <span style="color:#a6e22e">web</span> <span style="color:#a6e22e">server</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">type</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">php</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">request</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">launch</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">runtimeArgs</span><span style="color:#e6db74">&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#f92672">-</span><span style="color:#a6e22e">dxdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">mode</span><span style="color:#f92672">=</span><span style="color:#a6e22e">debug</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#f92672">-</span><span style="color:#a6e22e">dxdebug</span><span style="color:#f92672">.</span><span style="color:#a6e22e">start_with_request</span><span style="color:#f92672">=</span><span style="color:#a6e22e">yes</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#f92672">-</span><span style="color:#a6e22e">S</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#a6e22e">localhost</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            ],
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">program</span><span style="color:#e6db74">&#34;: &#34;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">cwd</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#960050;background-color:#1e0010">$</span>{<span style="color:#a6e22e">workspaceRoot</span>}<span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">port</span><span style="color:#e6db74">&#34;: 9003,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;</span><span style="color:#a6e22e">serverReadyAction</span><span style="color:#e6db74">&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#a6e22e">pattern</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">Development</span> <span style="color:#a6e22e">Server</span> <span style="color:#a6e22e">\\</span>(<span style="color:#a6e22e">http</span><span style="color:#f92672">://</span><span style="color:#a6e22e">localhost</span><span style="color:#f92672">:</span>([<span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">9</span>]<span style="color:#f92672">+</span>)<span style="color:#a6e22e">\\</span>) <span style="color:#a6e22e">started</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#a6e22e">uriFormat</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">http</span><span style="color:#f92672">://</span><span style="color:#a6e22e">localhost</span><span style="color:#f92672">:%</span><span style="color:#a6e22e">s</span><span style="color:#e6db74">&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">                &#34;</span><span style="color:#a6e22e">action</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#a6e22e">openExternally</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span></code></pre></div><p>Then Go to Explorer
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/Explorer.png">
open phpinfo.php file and set breakpoint
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/phpinfo-breakpoint.png">
Go to <code>Run - Start Debugging</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/test-debugging-xdebug.png">
You will see the debugging bar appears
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/Debuggin-Bar.png">
when you visit <a href="http://localhost:8000/phpinfo.php/">http://localhost:8000/phpinfo.php/</a> at browser
You will see that the breakpoint is triggered
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/phpinfo-breakpoint-triggered.png"></p>
<p>Lets begin the analysis</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">unzip</span> <span style="color:#a6e22e">easy</span><span style="color:#f92672">-</span><span style="color:#a6e22e">digital</span><span style="color:#f92672">-</span><span style="color:#a6e22e">downloads</span><span style="color:#ae81ff">.3.1.0.3</span>.<span style="color:#a6e22e">zip</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#a6e22e">easy</span><span style="color:#f92672">-</span><span style="color:#a6e22e">digital</span><span style="color:#f92672">-</span><span style="color:#a6e22e">downloads</span><span style="color:#ae81ff">.3.1.0.3</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">unzip</span> <span style="color:#a6e22e">easy</span><span style="color:#f92672">-</span><span style="color:#a6e22e">digital</span><span style="color:#f92672">-</span><span style="color:#a6e22e">downloads</span><span style="color:#ae81ff">.3.1.0.4</span>.<span style="color:#a6e22e">zip</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">d</span> <span style="color:#a6e22e">easy</span><span style="color:#f92672">-</span><span style="color:#a6e22e">digital</span><span style="color:#f92672">-</span><span style="color:#a6e22e">downloads</span><span style="color:#ae81ff">.3.1.0.4</span>
</span></span></code></pre></div><p>We will use <code>meld</code> to compare between the original file with the patched one to install meld <code>sudo apt install meld</code>
<br>
From the vulnerability description the vulnerable action is <code>edd_download_search</code>
<br>
We will search all php files that contains this action <code>edd_download_search</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">grep</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">r</span> <span style="color:#e6db74">&#34;edd_download_search&#34;</span> . <span style="color:#f92672">|</span>  <span style="color:#a6e22e">grep</span> <span style="color:#e6db74">&#39;\.php&#39;</span>
</span></span></code></pre></div><p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/edd_download_search-word.png">
The <code>ajax-functions.php</code> is the file that contains the action <code>edd_download_search</code></p>
<p>run <code>meld</code> command</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">meld</span>
</span></span></code></pre></div><p>Press File Tab
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/meld-window.png"></p>
<p>Press here to choose the first file <code>easy-digital-downloads.3.1.0.3/easy-digital-downloads/includes/ajax-functions.php</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/meld-window-file1.png">
Press here to choose the second file <code>/easy-digital-downloads.3.1.0.4/easy-digital-downloads/includes/ajax-functions.php</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/meld-window-file2.png">
The press Compare Button
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/meld-window-compares.png">
Check this box to show line numbers of the code
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/display-numbers.png">
As you can see the variable <code>$new_search</code> in the patched version is sanitized
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/meld-compare-results.png"></p>
<p>If you open code at the vulnerable version you see the variable <code>$new_search</code> is passed with GET Method of <code>s</code> parameter
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/edd_download_search-GET-s.png"></p>
<p>The variable <code>$new_search</code> is under <code>function edd_ajax_download_search()</code>
<br>
If you searched through the code for <code>edd_ajax_download_search</code></p>
<p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/edd_download_search-search.png">
According to <a href="https://developer.wordpress.org/reference/hooks/wp_ajax_action/">wordpress</a>  this is the format of AJAX Actions <code>do_action(&quot;wp_ajax_{$action}&quot;)</code></p>
<p>So:-</p>
<ul>
<li><code>wp_ajax_edd_download_search</code>  Runs <code>edd_ajax_download_search()</code> for logged-in users.</li>
<li><code>wp_ajax_nopriv_edd_download_search</code>  Runs <code>edd_ajax_download_search()</code> for non-logged-in users.
so if we want to get <code>edd_ajax_download_search</code> action it will be <code>edd_download_search</code> so the url should be like that</li>
</ul>
<pre tabindex="0"><code class="language-jfx" data-lang="jfx">http://localhost:8000/wp-admin/admin-ajax.php?action=edd_download_search&amp;s={user-input}
</code></pre><p>We removed the <code>ajax</code> keyword from <code>edd_ajax_download_search</code> because WordPress automatically maps AJAX requests using <code>admin-ajax.php</code> based on <code>add_action()</code> hooks.This is the default entry point for AJAX requests in WordPress.</p>
<p>Lets continue analysis
if you search for variable <code>$new_search</code> inside the code you will find it&rsquo;s passed to an array of variable <code>$args</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/args-variable.png">
Let&rsquo;s set a Breakpoint at this variable and make the request to make sure it is valid
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/breakpoint2.png"></p>
<p>If you go to the url</p>
<pre tabindex="0"><code class="language-jfx" data-lang="jfx">http://localhost:8000/wp-admin/admin-ajax.php?action=edd_download_search&amp;s=5555
</code></pre><p>You will find that the variable <code>$new_search</code> value changed to 5555
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/new_search_value.png"></p>
<p>If you searched for variable <code>$args</code> inside the function <code>edd_ajax_download_search</code> you see it&rsquo;s passed to <code>get_posts</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/args-variable2.png"></p>
<p>Let&rsquo;s search the files to see where is the function of <code>get_posts</code> located
<br>
You can get it either from command line of a container shell</p>
<pre tabindex="0"><code class="language-jfx" data-lang="jfx">grep -r &#34;function get_posts()&#34; . | grep &#39;\.php&#39;
</code></pre><p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/get_posts-cmd.png">
Or from Visual Studio Code
Go to search icon and type <code>function get_posts()</code> you will see it&rsquo;s in the file <code>class-wp-query.php</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/get_posts-visual-code.png"></p>
<p>The function <code>get_posts()</code> is wordpress function used in the class WP_Query</p>
<p>We will add this code in functions.php to see the full SQL query</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#a6e22e">add_filter</span>(<span style="color:#e6db74">&#39;posts_request&#39;</span>, <span style="color:#66d9ef">function</span>($sql, $query) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">error_log</span>(<span style="color:#e6db74">&#34;SQL Query: &#34;</span> <span style="color:#f92672">.</span> $sql);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $sql;
</span></span><span style="display:flex;"><span>}, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>);
</span></span></code></pre></div><p><img alt="Image" loading="lazy" src="/images/cve-2023-23489/locate-functions.png">
As you see the active theme is <code>Twenty Twenty-Five</code> Theme
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/active-theme.png">
so well edit that functions.php file <code>/wp-content/themes/twentytwentyfive/functions.php</code>
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/edit-functions.png">
If you go to the url</p>
<pre tabindex="0"><code class="language-jfx" data-lang="jfx">http://localhost:8000/wp-admin/admin-ajax.php?action=edd_download_search&amp;s=5555
</code></pre><p>There will a file called <code>debug.log</code> under wp-content will be generated and contains the Full SQL Query
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/SQL-Quyery.png">
As you se the user input isn&rsquo;t sanitized so that it&rsquo;s vulnerable to SQL injection</p>
<pre tabindex="0"><code class="language-jfx" data-lang="jfx">http://localhost:8000/wp-admin/admin-ajax.php?action=edd_download_search&amp;s=5555%27+AND+(SELECT+1+FROM+(SELECT(SLEEP(5)))a)--+-
</code></pre><p>We test this Time Based SQLi Query
<img alt="Image" loading="lazy" src="/images/cve-2023-23489/SQL-Time-Based.png"></p>
<h3 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h3>
<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-23489/">https://nvd.nist.gov/vuln/detail/CVE-2023-23489/</a>
<a href="https://wpscan.com/vulnerability/c5a6830c-6420-42fc-b20c-8e20224d6f18/">https://wpscan.com/vulnerability/c5a6830c-6420-42fc-b20c-8e20224d6f18/</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:61963/tags/cve_analysis/">Cve_analysis</a></li>
      <li><a href="http://localhost:61963/tags/xdebug/">Xdebug</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })
</script>


<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script>
    mediumZoom('img', {
        background: 'rgba(0, 0, 0, 0.8)',
        margin: 20
    });
</script>
</body>

</html>
